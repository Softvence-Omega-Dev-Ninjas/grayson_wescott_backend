model Program {
  id String @id @default(uuid())

  name        String
  description String?
  coachNote   String?

  // relation to categories table through join table
  programCategories ProgramCategory[]

  status   ProgramStatus
  duration Int // in weeks

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  // relations
  exercises    ProgramExercise[]
  userPrograms UserProgram[]

  @@map("programs")
}

model Category {
  id String @id @default(uuid())

  name String @unique

  description String?

  // relation to programs through join table
  programCategories ProgramCategory[]

  @@map("categories")
}

model ProgramCategory {
  id String @id @default(uuid())

  program   Program @relation(fields: [programId], references: [id], onDelete: Cascade)
  programId String

  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  categoryId String

  @@unique([programId, categoryId], map: "program_category_unique")
  @@map("program_categories")
}

model UserProgram {
  id String @id @default(uuid())

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId String

  program   Program @relation(fields: [programId], references: [id], onDelete: Cascade)
  programId String

  status ProgramProgress @default(IN_PROGRESS)

  startDate DateTime  @default(now())
  endDate   DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  userProgramExercise UserProgramExercise[]

  @@unique([userId, programId], map: "user_programs_unique")
  @@map("user_programs")
}

enum ProgramStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
  COMPLETED
}

enum ProgramProgress {
  IN_PROGRESS
  PAUSED
  COMPLETED
}
